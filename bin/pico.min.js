(function(e,r,t){var n,i,o=Date.now(),a=function(){},u=function(){arguments[arguments.length-1]()},s={run:a,inherit:a,reload:a,parse:a,define:a,import:a,export:a,env:a,ajax:a},c={},f={},l={},h={},p={},g="undefined"==typeof requestAnimationFrame?function(e){return setTimeout(e,100)}:requestAnimationFrame,d=function(e){return e.substring(e.indexOf("{")+1,e.lastIndexOf("}"))},v=function(e){if(!e)return null;var r=e.lastIndexOf(".");return-1!==r&&-1===e.indexOf("/",r)?e.substr(r):null},y=function(e,r){if(!e.length)return r();m(e.shift(),function(t){if(t)return r(t);y(e,r)})},m=function(e,r){if(c[e])return r(null,c[e]);var t=e.indexOf("/"),i=~t?l[e.slice(0,t)]:0,o=i?e.slice(t+1):e;(i=i||l["~"]||"")instanceof Function?i(o,function(t,n){if(t)return r(t);c[e]=n,r(null,n)}):n("get",i+o+(v(e)?"":".js"),null,null,function(t,n,i){if(4===n)return t?r(t):void D(e,i,r)})},b=function(e){return Object.defineProperties(Function("return arguments.callee.__proto__.apply(this,arguments)"),{name:{value:e},i:{value:o}})},k=function(e){return"function"==typeof e&&o===e.i},w=function(e,r){return e&&e!==r?(k(e)&&(e.prototype=r.prototype),e.__proto__=r,e):r},x=function(e){return k(e)?e.__proto__:e},S=function(e,r){return e?O(e,this,r):this},O=function(e,r,t){var n=x(e),i=x(r),o=typeof n,a=typeof i;switch(o){case"function":var u=n,s=n.prototype;break;case"object":if(o===a)return n.__proto__=i,n;var u=function(){return i.apply(this,arguments)},s=n;break;default:return n}switch(Object.assign(u,i,x(t)),a){case"function":return(c=u.prototype=Object.assign(Object.create(i.prototype),s)).constructor=u,(n.__super__=i.prototype).constructor=i,u;case"object":var c=u.prototype=Object.assign(Object.create(i),s);return c.constructor=u,n.__super__=i,u;default:return n}},T=function(e,r){var t=c[e];return void 0===t?r?m(e,r):c[e]=b(e):(r&&setTimeout(r,0,null,t),t)},j=function(e,r,t,n){n=n||s;var i=e?'"use strict";\n'+r+(h.live?"":"//# sourceURL="+e):r,o=function(e){return c[e]||t.push(e),c[e]};try{var u=Function("exports","require","module","define","inherit","pico",i)}catch(r){return console.error(e,r.message)}return u.call({},{},o,{},a,o,n),u},A=function(e,r,t){var n=v(e)||".js",i=p[n];switch(i&&(r=i(e,r)),n){case".js":var o,a={exports:{}},u={},s=r.call(t?{}:u,a.exports,T,a,A,function(e){return o=T(e)},M)||a.exports;return o&&(s=O(s,o)),"function"==typeof s&&(s.extend=S),u.load&&u.load(s),u.update&&(f[e]=[u.update,s]),e?c[e]=w(c[e],s):s;case".json":try{return c[e]=JSON.parse(r)}catch(r){return console.error(e,r.message)}default:return c[e]=r}},D=function(e,r,t){if(t=t||a,c[e])return t(null,c[e]);if(".js"!==(v(e)||".js"))return t(null,A(e,r));var n=[],i=j(e,r,n);e&&(c[e]=b(e)),y(n,function(r){if(r)return t(r);t(null,A(e,i))})},E=function(e){var r;for(var t in f)(r=f[t])&&r[0](r[1],e);g(E)},M=e[r]={run:function(e,r){M.ajax=n=e.ajax||n,l=e.paths||l,h=e.env||h,p=e.preprocessors||p,i=e.importRule;var t;for(var o in c)(t=p[v(o)||".js"])&&(c[o]=t(o,c[o]));(e.onLoad||u)(function(){D(e.name||null,d(r.toString()),function(e,r){if(e)return console.error(e);r&&r(),g(E)})})},reload:function(e,r,t){"function"==typeof r&&(t=r),t=t||a;var n=function(r,n){if(r)return t(r);t(null,c[e]=w(c[e],n))};delete c[e],t===r?m(e,n):D(e,r,n)},parse:D,define:A,import:function(e){if(!Array.isArray(i)||-1!==i.indexOf(e))return t(e)},export:T,env:function(e){return h[e]}};A("pico/json",function(e,r,t,n,i,o){return{parse:function(e,r){return JSON.parse(e[0],function(t,n){switch(t[0]){case"$":if(r)return JSON.parse(e[n]);case"_":return e[n];default:return n}})},stringify:function(e,r){var t=[];return t.unshift(JSON.stringify(e,function(e,n){switch(e[0]){case"$":if(r)return t.push(JSON.stringify(n));case"_":return t.push(n);default:return n}})),t},path:function(e){function r(e,r){return r<0?(e.length||0)+r:r}function t(e,r){if(!e||!r||"object"!=typeof r)return r;if(r[e])return r[e];for(var n,i,o=[],a=Object.keys(r),u=0;i=a[u];u++)(n=t(e,r[i]))&&Array.isArray(n)?o.push.apply(o,n):o.push(n);return o}function n(){if(!arguments.length)return i;var e=Array.isArray(i);switch(typeof arguments[0]){case"string":var o=arguments[0];switch(o){default:if(e){if(!i[0][o])break;i=i.map(function(e){return e[o]})}else{if(!i[o])break;i=i[o]}break;case"..":i=t(arguments[1],i)||i;break;case"*":if(e)break;i=Object.keys(i).map(function(e){return i[e]})}break;case"object":var a=arguments[0];if(!Array.isArray(a))break;i=a.map(function(e){return i[r(i,e)]});break;case"number":for(var u=r(i,arguments[0]),s=r(i,arguments[1])||i.length-1||0,c=arguments[2]||1,f=[],l=[],h=u;h<=s;h+=c)f.push(i[h]),l.push(h);i=f;break;case"function":var p=arguments[0];i=e?i.map(p):p(i),e&&(i=i.filter(function(e){return void 0!=e}))}return 1===i.length&&(i=i.pop()),n}var i=e;return n}}}),A("pico/obj",function(){var e=["object","function"];return{extend:function r(t,n,i){var o=e.indexOf(typeof t);if(-1===o)return n;var a=e.indexOf(typeof n);if(-1===a)return t;if(1===a&&a===o)return n.prototype=t,n;var u,s,c=(i=i||{}).tidy;if(1===a||void 0===n.length)for(u in n)void 0===(s=n[u])&&c||(t[u]=r(t[u],s,i));else if(i.mergeArr){var f,l,h={};for(f=0,l=t.length;f<l;f++)void 0===(s=t[f])&&c||(h[s]=s);for(f=0,l=n.length;f<l;f++)void 0===(s=n[f])&&c||(h[s]=s);t=[];for(u in h)t.push(h[u])}else t=n;return t},extends:function(e,r,t){for(var n,i=this.extend,o=0;n=r[o];o++)e=i(e,n,t);return e},parseInts:function(e,r){for(var t=0,n=e.length;t<n;t++)e[t]=parseInt(e[t],r);return e},pluck:function(e,r){var t=[];if(e.length){var n,i,o,a,u,s={};for(o=0,a=e.length;o<a;o++)(n=e[o])&&void 0!==(i=n[r])&&(s[i]=i);for(u in s)t.push(s[u])}return t},dotchain:function e(r,t,n){if(!t||!t.length)return r;var i=r[t.shift()];return i?e(i,t):n}}}),A("pico/str",function(){Math.ceil;var e=Math.random,r=function(e,r){var t=r[0];return"["+(t.getFunctionName()||t.getTypeName()+"."+t.getMethodName())+"@"+(t.isEval()?t.getEvalOrigin():t.getFileName())+":"+t.getLineNumber()+":"+t.getColumnNumber()+"]"},t=function(e){var r=e.search("[#:%]");switch(r){case-1:case 0:return e}return[e.substring(0,r),e.substr(r)]},n=function(e,r,i,o){var a=e.indexOf("/",r);if(-1===a)return i.push(t(e.substring(r))),o(null,i);i.push(t(e.substring(r,a))),n(e,a+1,i,o)},i=function(e,r,t){if(!e.length)return t(null,r);n(e.shift(),0,[],function(n,o){if(n)return t(n);r.push(o),i(e,r,t)})},o=function(e,r,t,n,i){switch(e[0]){default:return e===r;case"%":i[e.substr(1)]=parseFloat(r);break;case":":i[e.substr(1)]=r;break;case"#":i[e.substr(1)]=t.slice(n).join("/")}return!0},a=function(e,r,t){if(e.length<r.length)return!1;for(var n,i,a=0,u=r.length;a<u;a++)if(i=r[a],n=e[a],Array.isArray(i)){if(0!==n.indexOf(i[0]))return!1;if(!o(i[1],n.substr(i[0].length),e,a,t))return!1}else if(!o(i,n,e,a,t))return!1;return e.splice(0,u),!0};return{codec:function(e,r){for(var t,n=0,i="";t=r.charCodeAt(n);n++)i+=String.fromCharCode(t^e);return i},hash:function(e){for(var r,t=0,n=0;r=e.charCodeAt(t);t++)n=(n<<3)-n+r|0;return n},rand:function(){return e().toString(36).substr(2)},pad:function(e,r,t){return this.tab(e,r,t)+e},tab:function(e,r,t){var n=r-String(e).length+1;return Array(n>0?n:0).join(t||"0")},template:function(e){for(var r,t=/<%(.+?)%>/g,n=/(^( )?(var|if|for|else|switch|case|break|{|}|;))(.*)?/g,i="var r=[];\n",o=0,a=function(e,r){return i+=r?e.match(n)?e+"\n":"r.push("+e+");\n":""!=e?'r.push("'+e.replace(/"/g,'\\"')+'");\n':"",a};r=t.exec(e);)a(e.slice(o,r.index))(r[1],!0),o=r.index+r[0].length;return a(e.substr(o,e.length-o)),new Function("d",(i+'return r.join("");').replace(/[\r\t\n]/g," "))},compileRest:function(e,r){return r=r||[],-1===e.search("[|#:%]")?r:(i(e.split("|"),[e],function(e,t){if(e)throw e;r.push(t)}),r)},execRest:function(e,r,t){for(var n,i,o,u=e.split("/"),s=0;n=r[s];s++)if(a(u,n[1],t)){for(i=2;(o=n[i])&&a(u,o,t);i++);return n[0]}return null},log:function e(){var t=Error.prepareStackTrace,n=Error.stackTraceLimit;Error.prepareStackTrace=r,Error.stackTraceLimit=1;var i=new Error;Error.captureStackTrace(i,arguments[0]||e);var o=[(new Date).toISOString(),i.stack];console.log.apply(console,o.concat(Array.prototype.slice.call(arguments,1))),Error.prepareStackTrace=t,Error.stackTraceLimit=n},error:function e(){var r=Error.stackTraceLimit;Error.stackTraceLimit=4;var t=new Error;Error.captureStackTrace(t,arguments[0]||e);var n=[(new Date).toISOString()];(n=n.concat(Array.prototype.slice.call(arguments,1))).push("\n"),console.error.apply(console,n.concat(t.stack)),Error.stackTraceLimit=r}}}),A("pico/time",function(){var e=Math.max,r=Math.min,t=Math.floor,n=Math.ceil,i=function(e,r){return(e-r)/864e5},o=function(e,r,t){var a=r?1:0,u=new Date(e.getFullYear()+(t||0),0,1),s=(7-u.getDay())%7+a,c=i(e,u);return c>s?n((c-s)/7):o(e,r,-1)},a=function(e,r,t){var n=e.split("/"),i=n[0];if("*"===i)n[0]=r;else if((i=n[0]=parseInt(i))<r||i>t)return;return 1===n.length?n.push(0):n[1]=parseInt(n[1]),n},u=function(e,r,t){if("*"===e)return 0;var n=[];list=e.split(",");for(var i,o,u,s,c,f,l,h=0;i=list[h];h++){if(!(u=i.split("-")).length)return null;if(s=a(u[0],r,t),1!==u.length)if(c=a(u[1],r,t),o=s[0],f=c[0],l=c[1]||1,o>f){for(f=t;o<=f;o+=l)n.push(o);for(o=r,f=c[0];o<=f;o+=l)n.push(o)}else for(;o<=f;o+=l)n.push(o);else if(l=s[1])for(o=s[0];o<=t;o+=l)n.push(o);else n.push(s[0])}return n.sort(function(e,r){return e-r}),n},s=function(t,n,i){if(!n)return t;if(e.apply(Math,n.concat(t))===t)return t+(i-t)+r.apply(Math,n);for(var o=0,a=n.length;o<a;o++)if(n[o]>=t)return n[o];console.error("not suppose to be here",t,n,i)},c=function(e,r,n,i,o,a,u,f,l){if(r++>1)return l(0);var h=s(e.getMinutes(),n,60),p=s(e.getHours()+t(h/60),i,24),g=e.getDate(),d=e.getMonth(),v=e.getFullYear(),y=new Date(v,d,0).getDate();if(u){var m=e.getDay()+t(p/24);g+=s(m,u,7)-m}else g=s(g+t(p/24),o,y);if(d=s(d+1+t(g/y),a,12),e.getMonth()+1!==d)return c(new Date(v,d-1),r,n,i,o,a,u,f,l);if(v=s(v+t((d-1)/12),f,0),e.getFullYear()!==v)return c(new Date(v,d-1),r,n,i,o,a,u,f,l);var b=new Date(v,(d-1)%12).getTime();return b+=864e5*(g%y-1),b+=p%24*36e5,b+=h%60*6e4,l(b)};return{parse:function(e){var r=e.split(" ");if(r.length<6)return 0;var t=u(r[0],0,59);if(null==t)return 0;var n=u(r[1],0,23);if(null==n)return 0;var i=u(r[2],1,31);if(null==i)return 0;var o=u(r[3],1,12);if(null==o)return 0;var a=u(r[4],0,6);if(null==a)return 0;var s=u(r[5],1975,2075);return null==s?0:[t,n,i,o,a,s]},nearest:function(e,r,t,n,i,o){var a=new Date,u=s(a.getFullYear(),o,0),f=s(a.getMonth()+1,n,12)-1;if(a.getFullYear()!==u||a.getMonth()!==f)a=new Date(u,f);else{var l=a.getTime();a=new Date(l+6e4)}return c(a,0,e,r,t,n,i,o,function(e){return e})},daynum:i,weeknum:o,day:function(e,r){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate(),12,0,0)-e;return n>=0&&n<=1296e5||n<=0&&n>-1296e5?t.getDate()===e.getDate()?"Today":t>e?"Yesterday":"Tomorrow":(r=r||"en-US",t.getFullYear()===e.getFullYear()&&o(t)===o(e)?e.toLocaleDateString(r,{weekday:"long"}):e.toLocaleDateString(r,{weekday:"short",month:"short",day:"numeric"}))}}}),A("pico/web",function(e,r,t,i,o,a){function u(e){if(!e.url)return console.error("url is not set");k(this,Object.assign({cullAge:0,delimiter:["&"]},e)),this.reqId=1+f(1e3*l()),this.inbox=[],this.outbox=[],this.uploads=[],this.callbacks={},this.acks=[],this.reqs=[],this.resEndPos=0,this.head=null,this.body=[],this.currPT=h,this.serverTime=0,this.serverTimeAtClient=0}var s=r("pico/json"),c=Math.abs,f=Math.floor,l=Math.random,h=1,p=!0,g=function(e){e&&console.error(e)},d=function(e,r,t){e.append(r,t)},v=function(e,r,t){e[r]=t},y=function(e,r){r=r||g,n("get",e.url,null,null,function(t,n,i){if(4===n){if(t)return r(t);var o=parseInt(i);if(isNaN(o))return r("invalid timesync response");e.serverTime=o,e.serverTimeAtClient=Date.now(),r()}})},m=function(e,r,t,n){switch(e&&4===r&&y(n),r){case 2:n.head=null,n.currPT=h,n.resEndPos=0}if(t){var i,o=n.resEndPos,a=-1,u=n.delimiter,f=u.length,l=n.body;try{for(;;){if(-1===(a=t.indexOf(u,o)))break;switch(n.currPT){case h:n.head=JSON.parse(t.substring(o,a)),l.length=0,n.currPT=2;break;case 2:l.push(t.substring(o,a))}if((i=n.head)&&i.len===l.length){if(n.currPT=h,i.resId&&n.request("ack",{resId:i.resId}),!i.reqId)return void console.error("incomplete response header: "+JSON.stringify(i));if(n.cullAge&&n.cullAge<c(n.getServerTime()-i.date))return void console.error("invalid server time: "+JSON.stringify(i)+" "+c(n.getServerTime()-i.date));if(n.secretKey&&l.length){for(var p=CryptoJS.algo.HMAC.create(CryptoJS.algo.MD5,n.secretKey+i.date),g=0,d=l.length;g<d;g++)p.update(l[g]);if(i.key!==p.finalize().toString(CryptoJS.enc.Base64))return void console.error("invalid server key: "+JSON.stringify(i))}i.len&&(i.data=s.parse(l,!0)),n.inbox.push(i),n.head=null}o=a+f}}catch(e){console.error(e)}n.resEndPos=4===r?0:o}},b=function(e,r,t,n,i){n=n||"",i=i||"";for(var o,a,u,s,c=e instanceof FormData?d:v,f=r.baseURI,l=0,h=r.elements;s=h[l];l++)if(s.hasAttribute("name"))if("FILE"===(o=s.hasAttribute("type")?s.getAttribute("type").toUpperCase():"TEXT"))for(a=0,u=s.files.length;a<u;c(e,n+s.name,s.files[a++]));else("RADIO"!==o&&"CHECKBOX"!==o||s.checked)&&c(e,n+s.name,s.value);if(t)for(var p in t)c(e,i+p,t[p]);return f=f.substring(0,f.lastIndexOf("/")+1),r.action.substr(f.length)},k=function(e,r){e.url=r.url||e.url,e.secretKey=r.secretKey||e.secretKey,e.cullAge=r.cullAge||e.cullAge,e.delimiter=r.delimiter?JSON.stringify(r.delimiter):e.delimiter},w=function(e){e.resEndPos=e.outbox.length=e.acks.length=0,e.currPT=h};return u.prototype={beat:function(){if(this.inbox.length)for(var e,r,t,i=this.inbox,o=this.callbacks;t=i.pop();)(r=o[e=t.reqId])&&(delete o[e],r(t.error,t.data));if(p&&(this.uploads.length||this.outbox.length||this.acks.length)){var a=this.uploads,u=this.outbox,s=this.acks;if(a.length)n("post",this.url,a.shift(),null,m,this);else{var c=this.reqs=s.concat(u);s.length=u.length=0,n("post",this.url,c.join(this.delimiter)+this.delimiter,null,m,this)}}},reconnect:function(e,r){k(this,e),w(this),y(this,function(e){r(e,this)})},submit:function(e,r,t){if(!("undefined"!=typeof window&&e&&e instanceof HTMLFormElement))return console.error("No HTMLFormElement submitted");var n=0;t&&(n=this.reqId++,this.callbacks[n]=t);var i=new FormData;i.append("api",b(i,e,r,"data/","cred/")),i.append("reqId",n),this.uploads.push(i)},request:function(e,r,t,n){switch(arguments.length){case 2:r instanceof Function&&(n=r,r=t=void 0);break;case 3:t instanceof Function&&(n=t,t=void 0);break;case 4:break;default:return console.error("wrong request params!")}if("undefined"!=typeof window&&r instanceof HTMLFormElement){var i={};e=b(i,r),r=i}if(!e)return console.error("Missing api,  data["+JSON.stringify(r)+"]");var o=this.acks;if("ack"!==e&&(o=this.outbox).length){var a=o.shift();-1===a.indexOf(e)&&o.unshift(a)}var u=0;n&&(u=this.reqId++,this.callbacks[u]=n);var c=r?s.stringify(r,!0):[];if(c.unshift(JSON.stringify(t)),c.length&&this.secretKey){for(var f=this.getServerTime(),l=CryptoJS.algo.HMAC.create(CryptoJS.algo.MD5,this.secretKey+f),h=0,p=c.length;h<p;h++)l.update(c[h]);c.unshift(JSON.stringify({api:e,reqId:u,len:c.length,date:f,key:l.finalize().toString(CryptoJS.enc.Base64)}))}else c.unshift(JSON.stringify({api:e,reqId:u,len:c.length}));o.push(c.join(this.delimiter))},getServerTime:function(){return this.serverTime+(Date.now()-this.serverTimeAtClient)},test:function(e){y(this,e)}},{create:function(e,r){var t=new u(e);return y(t,function(e){r&&r(e,t)}),t},ajax:n,online:function(){p=!0},offline:function(){p=!1}}})}).apply(null,"undefined"==typeof window?[module,"exports",require]:[window,"pico"]);
//# sourceMappingURL=bin/pico.min.js.map